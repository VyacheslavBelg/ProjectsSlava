{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\slava\\\\Desktop\\\\\\u0423\\u043D\\u0438\\u0432\\u0435\\u0440\\\\3 \\u043A\\u0443\\u0440\\u0441\\\\RIP\\\\MegaGigaChat\\\\ChatApp2.0\\\\chat-client\\\\src\\\\App.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { HubConnectionBuilder, LogLevel } from '@microsoft/signalr';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport './App.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n// –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ—Ä—Ç, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–≤–æ–¥–∏—Ç –≤–∞—à —Å–µ—Ä–≤–µ—Ä ASP.NET Core\nconst CHAT_HUB_URL = \"http://localhost:5157/chatHub\";\nconst App = () => {\n  _s();\n  // –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è\n  const [connection, setConnection] = useState(null);\n\n  // –°–æ—Å—Ç–æ—è–Ω–∏–µ —á–∞—Ç–∞\n  const [messages, setMessages] = useState([]);\n  const [username, setUsername] = useState('');\n  const [roomId, setRoomId] = useState('');\n  const [roomName, setRoomName] = useState(''); // –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–Ω–∞—Ç—ã\n  const [isInRoom, setIsInRoom] = useState(false);\n  const [inputText, setInputText] = useState('');\n\n  // –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∫–æ–º–Ω–∞—Ç\n  const [myRooms, setMyRooms] = useState([]);\n  const [showRooms, setShowRooms] = useState(false);\n\n  // –°—Å—ã–ª–∫–∞ –Ω–∞ div —Å —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –¥–ª—è –∞–≤—Ç–æ-—Å–∫—Ä–æ–ª–ª–∞\n  const messagesEndRef = useRef(null);\n\n  // 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è\n  useEffect(() => {\n    const newConnection = new HubConnectionBuilder().withUrl(CHAT_HUB_URL).withAutomaticReconnect().configureLogging(LogLevel.Information).build();\n    setConnection(newConnection);\n  }, []);\n\n  // 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π –∏ –∑–∞–ø—É—Å–∫\n  useEffect(() => {\n    if (connection) {\n      connection.start().then(() => {\n        console.log('Connected to SignalR Hub');\n\n        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π\n        connection.on(\"ReceiveMessage\", message => {\n          setMessages(prev => [...prev, message]);\n        });\n\n        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π (–ø—Ä–∏ –≤—Ö–æ–¥–µ)\n        connection.on(\"ReceiveRoomHistory\", history => {\n          setMessages(history);\n        });\n\n        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫\n        connection.on(\"ReceiveError\", errorMsg => {\n          alert(`Error: ${errorMsg.text}`);\n          setIsInRoom(false);\n        });\n      }).catch(e => console.log('Connection failed: ', e));\n    }\n  }, [connection]);\n\n  // –ê–≤—Ç–æ-—Å–∫—Ä–æ–ª–ª –≤–Ω–∏–∑ –ø—Ä–∏ –Ω–æ–≤–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏\n  useEffect(() => {\n    var _messagesEndRef$curre;\n    (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n      behavior: \"smooth\"\n    });\n  }, [messages]);\n\n  // --- –§—É–Ω–∫—Ü–∏–∏ –¥–µ–π—Å—Ç–≤–∏–π (Client -> Server) ---\n\n  const createRoom = async () => {\n    if (!username) return alert(\"Enter username!\");\n    try {\n      const request = {\n        username,\n        roomName\n      };\n      const newRoomId = await (connection === null || connection === void 0 ? void 0 : connection.invoke(\"CreateRoom\", request));\n      if (newRoomId) {\n        setRoomId(newRoomId);\n        setIsInRoom(true);\n        setShowRooms(false);\n        setMessages([]);\n      }\n    } catch (e) {\n      console.error(\"Error creating room:\", e);\n    }\n  };\n  const joinRoom = async () => {\n    if (!username || !roomId) return alert(\"Enter username and Room ID!\");\n    await joinSpecificRoom(roomId);\n  };\n  const joinSpecificRoom = async id => {\n    setRoomId(id);\n    try {\n      const request = {\n        username,\n        roomId: id\n      };\n      const success = await (connection === null || connection === void 0 ? void 0 : connection.invoke(\"JoinRoom\", request));\n      if (success) {\n        setIsInRoom(true);\n        setShowRooms(false);\n      }\n    } catch (e) {\n      console.error(\"Error joining room:\", e);\n      alert(`Failed to join room ${id}. It may not exist.`);\n    }\n  };\n  const sendMessage = async () => {\n    if (!inputText) return;\n    try {\n      const msg = {\n        user: username,\n        text: inputText,\n        type: 'text',\n        timestamp: ''\n      };\n      await (connection === null || connection === void 0 ? void 0 : connection.invoke(\"SendMessageToRoom\", msg));\n      setInputText('');\n    } catch (e) {\n      console.error(\"Error sending message:\", e);\n    }\n  };\n  const leaveRoom = async () => {\n    try {\n      await (connection === null || connection === void 0 ? void 0 : connection.invoke(\"LeaveRoom\"));\n      setIsInRoom(false);\n      setMessages([]);\n      // –û—á–∏—â–∞–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã, –Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º username\n      setRoomId('');\n      setRoomName('');\n    } catch (e) {\n      console.error(\"Error leaving room:\", e);\n    }\n  };\n  const deleteRoom = async () => {\n    if (!window.confirm(\"Are you sure? Only the creator can delete the room.\")) return;\n    try {\n      await (connection === null || connection === void 0 ? void 0 : connection.invoke(\"DeleteRoom\", roomId, username));\n      // –°–µ—Ä–≤–µ—Ä —Å–∞–º –æ—Ç–∫–ª—é—á–∏—Ç –Ω–∞—Å –∏ —Å–æ–æ–±—â–∏—Ç –≤—Å–µ–º –æ–± —É–¥–∞–ª–µ–Ω–∏–∏,\n      // –Ω–æ –º—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º UI:\n      setIsInRoom(false);\n      setMessages([]);\n      setRoomId('');\n      setRoomName('');\n    } catch (e) {\n      console.error(\"Error deleting room:\", e);\n      alert(\"–£–¥–∞–ª–∏—Ç—å —á–∞—Ç –º–æ–∂–µ—Ç —Ç–æ–ª—å–∫–æ —Å–æ–∑–¥–∞—Ç–µ–ª—å\");\n    }\n  };\n\n  // --- –ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø: –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–º–Ω–∞—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ---\n\n  const loadUserRooms = async () => {\n    if (!username) return alert(\"–ü–æ–∂–∞–ª–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —Å–Ω–∞—á–∞–ª–∞ –∏–º—è!\");\n\n    // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º –≤–∏–¥–∏–º–æ—Å—Ç—å (–µ—Å–ª–∏ —É–∂–µ –≤–∏–¥–Ω–æ, —Ç–æ —Å–∫—Ä—ã–≤–∞–µ–º)\n    if (showRooms) {\n      setShowRooms(false);\n      return;\n    }\n    try {\n      // üëá –ò–°–ü–†–ê–í–õ–ï–ù–û: –î–æ–±–∞–≤–ª–µ–Ω Generic Type <string[]>\n      const roomIds = await (connection === null || connection === void 0 ? void 0 : connection.invoke(\"GetUserRoomIds\", username));\n      if (roomIds && roomIds.length > 0) {\n        // 2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ ID –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –¥–µ—Ç–∞–ª–∏\n        const roomsData = await Promise.all(\n        // –¢–∞–∫–∂–µ –¥–æ–±–∞–≤–ª—è–µ–º Generic Type –¥–ª—è GetRoomInfo\n        roomIds.map(id => connection === null || connection === void 0 ? void 0 : connection.invoke(\"GetRoomInfo\", id)));\n\n        // –§–∏–ª—å—Ç—Ä—É–µ–º null (–µ—Å–ª–∏ –∫–æ–º–Ω–∞—Ç–∞ —É–¥–∞–ª–µ–Ω–∞)\n        setMyRooms(roomsData.filter(r => r !== null));\n        setShowRooms(true);\n      } else {\n        alert(\"–ù–µ—Ç –∫–æ–º–Ω–∞—Ç —É –¥–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.\");\n        setMyRooms([]);\n        setShowRooms(false);\n      }\n    } catch (e) {\n      console.error(\"Error loading rooms:\", e);\n      alert(\"Could not load rooms. Check console for details.\");\n    }\n  };\n  // --- –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ ---\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container mt-5\",\n    children: !isInRoom ?\n    /*#__PURE__*/\n    // --- LOBBY SCREEN ---\n    _jsxDEV(\"div\", {\n      className: \"card p-4 mx-auto\",\n      style: {\n        maxWidth: '500px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-center mb-4\",\n        children: \"\\u041D\\u0430\\u0445\\u0443\\u0439\\u041C\\u0430\\u043A\\u0441\\u0427\\u0430\\u0442\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"form-label\",\n          children: \"\\u041D\\u0438\\u043A\\u043D\\u0435\\u0439\\u043C\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          className: \"form-control\",\n          placeholder: \"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0438\\u043C\\u044F\",\n          value: username,\n          onChange: e => setUsername(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 203,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"h5\", {\n        children: \"\\u0412\\u043E\\u0439\\u0442\\u0438 \\u0432 \\u043A\\u043E\\u043C\\u043D\\u0430\\u0442\\u0443 \\u043F\\u043E ID\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"input-group mb-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          className: \"form-control\",\n          placeholder: \"ID \\u043A\\u043E\\u043C\\u043D\\u0430\\u0442\\u044B\",\n          value: roomId,\n          onChange: e => setRoomId(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn btn-primary\",\n          onClick: joinRoom,\n          children: \"\\u0412\\u0445\\u043E\\u0434\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn btn-outline-info w-100 mb-3\",\n        onClick: loadUserRooms,\n        disabled: !username,\n        children: showRooms ? \"Hide Rooms\" : \"–ü–æ–∫–∞–∑–∞—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–Ω–∞—Ç—ã\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 21\n      }, this), showRooms && myRooms.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"list-group mb-3\",\n        children: myRooms.map(room => /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"list-group-item list-group-item-action d-flex justify-content-between align-items-center\",\n          onClick: () => joinSpecificRoom(room.roomId),\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: room.roomName\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 244,\n              columnNumber: 41\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"small text-muted\",\n              children: [\"ID: \", room.roomId, \" | Creator: \", room.creator]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 245,\n              columnNumber: 41\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 243,\n            columnNumber: 37\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"badge bg-primary rounded-pill\",\n            children: [room.userCount, \" users\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 247,\n            columnNumber: 37\n          }, this)]\n        }, room.roomId, true, {\n          fileName: _jsxFileName,\n          lineNumber: 238,\n          columnNumber: 33\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 25\n      }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"h5\", {\n        children: \"\\u0421\\u043E\\u0437\\u0434\\u0430\\u0442\\u044C \\u043A\\u043E\\u043C\\u043D\\u0430\\u0442\\u0443\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 258,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-2\",\n        children: /*#__PURE__*/_jsxDEV(\"input\", {\n          className: \"form-control\",\n          placeholder: \"\\u041D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435 \\u043A\\u043E\\u043C\\u043D\\u0430\\u0442\\u044B\",\n          value: roomName,\n          onChange: e => setRoomName(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 260,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 259,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn btn-success w-100\",\n        onClick: createRoom,\n        children: \"\\u0421\\u043E\\u0437\\u0434\\u0430\\u0442\\u044C \\u0438 \\u0432\\u043E\\u0439\\u0442\\u0438\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 267,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 17\n    }, this) :\n    /*#__PURE__*/\n    // --- CHAT ROOM SCREEN ---\n    _jsxDEV(\"div\", {\n      className: \"card mx-auto\",\n      style: {\n        maxWidth: '800px',\n        height: '80vh'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card-header d-flex justify-content-between align-items-center bg-primary text-white\",\n        children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n          className: \"mb-0\",\n          children: [\"\\u0412\\u044B \\u0432 \\u043A\\u043E\\u043C\\u043D\\u0430\\u0442\\u0435: \", roomId, \" (User: \", username, \")\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 273,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn btn-sm btn-danger me-2\",\n            onClick: deleteRoom,\n            children: \"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C \\u043A\\u043E\\u043C\\u043D\\u0430\\u0442\\u0443\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 275,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn btn-sm btn-warning\",\n            onClick: leaveRoom,\n            children: \"\\u0412\\u044B\\u0439\\u0442\\u0438\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 276,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 274,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 272,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card-body overflow-auto d-flex flex-column\",\n        style: {\n          flex: 1,\n          backgroundColor: '#f8f9fa'\n        },\n        children: [messages.map((msg, idx) => {\n          const isMyMessage = msg.user === username;\n          const isSystem = msg.type === 'system' || msg.type === 'join' || msg.type === 'leave' || msg.type === 'error';\n          if (isSystem) {\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-center text-muted small my-2\",\n              children: /*#__PURE__*/_jsxDEV(\"em\", {\n                children: [\"[\", msg.timestamp, \"] \", msg.text]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 288,\n                columnNumber: 41\n              }, this)\n            }, idx, false, {\n              fileName: _jsxFileName,\n              lineNumber: 287,\n              columnNumber: 37\n            }, this);\n          }\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `d-flex mb-3 ${isMyMessage ? 'justify-content-end' : 'justify-content-start'}`,\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `card px-3 py-2 ${isMyMessage ? 'bg-primary text-white' : 'bg-white border'}`,\n              style: {\n                maxWidth: '70%',\n                borderRadius: '15px',\n                border: isMyMessage ? 'none' : '1px solid #ddd'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"small fw-bold mb-1\",\n                style: {\n                  opacity: 0.8\n                },\n                children: msg.user\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 299,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: msg.text\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 300,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"small text-end mt-1\",\n                style: {\n                  opacity: 0.7,\n                  fontSize: '0.7em'\n                },\n                children: msg.timestamp\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 301,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 295,\n              columnNumber: 37\n            }, this)\n          }, idx, false, {\n            fileName: _jsxFileName,\n            lineNumber: 294,\n            columnNumber: 33\n          }, this);\n        }), /*#__PURE__*/_jsxDEV(\"div\", {\n          ref: messagesEndRef\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 306,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card-footer\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"input-group\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            className: \"form-control\",\n            placeholder: \"Type a message...\",\n            value: inputText,\n            onChange: e => setInputText(e.target.value),\n            onKeyDown: e => e.key === 'Enter' && sendMessage()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 311,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn btn-primary\",\n            onClick: sendMessage,\n            disabled: !connection || connection.state !== 'Connected',\n            children: \"Send\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 319,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 310,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 309,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 271,\n      columnNumber: 17\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 195,\n    columnNumber: 9\n  }, this);\n};\n_s(App, \"8UYI0Ggt7IvjPGh2Bftr2E830fY=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useEffect","useRef","HubConnectionBuilder","LogLevel","jsxDEV","_jsxDEV","CHAT_HUB_URL","App","_s","connection","setConnection","messages","setMessages","username","setUsername","roomId","setRoomId","roomName","setRoomName","isInRoom","setIsInRoom","inputText","setInputText","myRooms","setMyRooms","showRooms","setShowRooms","messagesEndRef","newConnection","withUrl","withAutomaticReconnect","configureLogging","Information","build","start","then","console","log","on","message","prev","history","errorMsg","alert","text","catch","e","_messagesEndRef$curre","current","scrollIntoView","behavior","createRoom","request","newRoomId","invoke","error","joinRoom","joinSpecificRoom","id","success","sendMessage","msg","user","type","timestamp","leaveRoom","deleteRoom","window","confirm","loadUserRooms","roomIds","length","roomsData","Promise","all","map","filter","r","className","children","style","maxWidth","fileName","_jsxFileName","lineNumber","columnNumber","placeholder","value","onChange","target","onClick","disabled","room","creator","userCount","height","flex","backgroundColor","idx","isMyMessage","isSystem","borderRadius","border","opacity","fontSize","ref","onKeyDown","key","state","_c","$RefreshReg$"],"sources":["C:/Users/slava/Desktop/–£–Ω–∏–≤–µ—Ä/3 –∫—É—Ä—Å/RIP/MegaGigaChat/ChatApp2.0/chat-client/src/App.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { HubConnection, HubConnectionBuilder, LogLevel } from '@microsoft/signalr';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport './App.css'; \nimport { ChatMessageDto, CreateRoomRequest, JoinRoomRequest, RoomInfoDto } from './types';\n\n// –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ—Ä—Ç, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–≤–æ–¥–∏—Ç –≤–∞—à —Å–µ—Ä–≤–µ—Ä ASP.NET Core\nconst CHAT_HUB_URL = \"http://localhost:5157/chatHub\"; \n\nconst App: React.FC = () => {\n    // –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è\n    const [connection, setConnection] = useState<HubConnection | null>(null);\n    \n    // –°–æ—Å—Ç–æ—è–Ω–∏–µ —á–∞—Ç–∞\n    const [messages, setMessages] = useState<ChatMessageDto[]>([]);\n    const [username, setUsername] = useState('');\n    const [roomId, setRoomId] = useState('');\n    const [roomName, setRoomName] = useState(''); // –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–Ω–∞—Ç—ã\n    const [isInRoom, setIsInRoom] = useState(false);\n    const [inputText, setInputText] = useState('');\n    \n    // –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∫–æ–º–Ω–∞—Ç\n    const [myRooms, setMyRooms] = useState<RoomInfoDto[]>([]); \n    const [showRooms, setShowRooms] = useState(false);\n\n    // –°—Å—ã–ª–∫–∞ –Ω–∞ div —Å —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –¥–ª—è –∞–≤—Ç–æ-—Å–∫—Ä–æ–ª–ª–∞\n    const messagesEndRef = useRef<HTMLDivElement>(null);\n\n    // 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è\n    useEffect(() => {\n        const newConnection = new HubConnectionBuilder()\n            .withUrl(CHAT_HUB_URL) \n            .withAutomaticReconnect()\n            .configureLogging(LogLevel.Information)\n            .build();\n\n        setConnection(newConnection);\n    }, []);\n\n    // 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π –∏ –∑–∞–ø—É—Å–∫\n    useEffect(() => {\n        if (connection) {\n            connection.start()\n                .then(() => {\n                    console.log('Connected to SignalR Hub');\n                    \n                    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π\n                    connection.on(\"ReceiveMessage\", (message: ChatMessageDto) => {\n                        setMessages(prev => [...prev, message]);\n                    });\n\n                    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π (–ø—Ä–∏ –≤—Ö–æ–¥–µ)\n                    connection.on(\"ReceiveRoomHistory\", (history: ChatMessageDto[]) => {\n                        setMessages(history);\n                    });\n\n                    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫\n                    connection.on(\"ReceiveError\", (errorMsg: ChatMessageDto) => {\n                        alert(`Error: ${errorMsg.text}`);\n                        setIsInRoom(false); \n                    });\n                })\n                .catch(e => console.log('Connection failed: ', e));\n        }\n    }, [connection]);\n\n    // –ê–≤—Ç–æ-—Å–∫—Ä–æ–ª–ª –≤–Ω–∏–∑ –ø—Ä–∏ –Ω–æ–≤–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏\n    useEffect(() => {\n        messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n    }, [messages]);\n\n    // --- –§—É–Ω–∫—Ü–∏–∏ –¥–µ–π—Å—Ç–≤–∏–π (Client -> Server) ---\n\n    const createRoom = async () => {\n        if (!username) return alert(\"Enter username!\");\n        try {\n            const request: CreateRoomRequest = { username, roomName };\n            const newRoomId = await connection?.invoke<string>(\"CreateRoom\", request);\n            \n            if (newRoomId) {\n                setRoomId(newRoomId);\n                setIsInRoom(true);\n                setShowRooms(false);\n                setMessages([]); \n            }\n        } catch (e) {\n            console.error(\"Error creating room:\", e);\n        }\n    }\n\n    const joinRoom = async () => {\n        if (!username || !roomId) return alert(\"Enter username and Room ID!\");\n        await joinSpecificRoom(roomId);\n    }\n    \n    const joinSpecificRoom = async (id: string) => {\n        setRoomId(id);\n        try {\n            const request: JoinRoomRequest = { username, roomId: id };\n            const success = await connection?.invoke<boolean>(\"JoinRoom\", request);\n            if (success) {\n                setIsInRoom(true);\n                setShowRooms(false);\n            }\n        } catch (e) {\n            console.error(\"Error joining room:\", e);\n            alert(`Failed to join room ${id}. It may not exist.`);\n        }\n    };\n\n\n    const sendMessage = async () => {\n        if (!inputText) return;\n        try {\n            const msg: ChatMessageDto = {\n                user: username,\n                text: inputText,\n                type: 'text',\n                timestamp: '' \n            };\n            await connection?.invoke(\"SendMessageToRoom\", msg);\n            setInputText('');\n        } catch (e) {\n            console.error(\"Error sending message:\", e);\n        }\n    }\n\n    const leaveRoom = async () => {\n        try {\n            await connection?.invoke(\"LeaveRoom\");\n            setIsInRoom(false);\n            setMessages([]);\n            // –û—á–∏—â–∞–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã, –Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º username\n            setRoomId('');\n            setRoomName('');\n        } catch (e) {\n            console.error(\"Error leaving room:\", e);\n        }\n    }\n\n    const deleteRoom = async () => {\n        if(!window.confirm(\"Are you sure? Only the creator can delete the room.\")) return;\n        try {\n            await connection?.invoke(\"DeleteRoom\", roomId, username);\n            // –°–µ—Ä–≤–µ—Ä —Å–∞–º –æ—Ç–∫–ª—é—á–∏—Ç –Ω–∞—Å –∏ —Å–æ–æ–±—â–∏—Ç –≤—Å–µ–º –æ–± —É–¥–∞–ª–µ–Ω–∏–∏,\n            // –Ω–æ –º—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º UI:\n            setIsInRoom(false);\n            setMessages([]);\n            setRoomId('');\n            setRoomName('');\n        } catch (e) {\n            console.error(\"Error deleting room:\", e);\n            alert(\"–£–¥–∞–ª–∏—Ç—å —á–∞—Ç –º–æ–∂–µ—Ç —Ç–æ–ª—å–∫–æ —Å–æ–∑–¥–∞—Ç–µ–ª—å\");\n        }\n    }\n\n    // --- –ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø: –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–º–Ω–∞—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ---\n\n    const loadUserRooms = async () => {\n        if (!username) return alert(\"–ü–æ–∂–∞–ª–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —Å–Ω–∞—á–∞–ª–∞ –∏–º—è!\");\n        \n        // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º –≤–∏–¥–∏–º–æ—Å—Ç—å (–µ—Å–ª–∏ —É–∂–µ –≤–∏–¥–Ω–æ, —Ç–æ —Å–∫—Ä—ã–≤–∞–µ–º)\n        if(showRooms) {\n            setShowRooms(false);\n            return;\n        }\n\n        try {\n            // üëá –ò–°–ü–†–ê–í–õ–ï–ù–û: –î–æ–±–∞–≤–ª–µ–Ω Generic Type <string[]>\n            const roomIds = await connection?.invoke<string[]>(\"GetUserRoomIds\", username);\n\n            if (roomIds && roomIds.length > 0) {\n                // 2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ ID –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –¥–µ—Ç–∞–ª–∏\n                const roomsData = await Promise.all(\n                    // –¢–∞–∫–∂–µ –¥–æ–±–∞–≤–ª—è–µ–º Generic Type –¥–ª—è GetRoomInfo\n                    roomIds.map(id => connection?.invoke<RoomInfoDto | null>(\"GetRoomInfo\", id))\n                );\n\n                // –§–∏–ª—å—Ç—Ä—É–µ–º null (–µ—Å–ª–∏ –∫–æ–º–Ω–∞—Ç–∞ —É–¥–∞–ª–µ–Ω–∞)\n                setMyRooms(roomsData.filter((r): r is RoomInfoDto => r !== null));\n                setShowRooms(true);\n            } else {\n                alert(\"–ù–µ—Ç –∫–æ–º–Ω–∞—Ç —É –¥–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.\");\n                setMyRooms([]);\n                setShowRooms(false);\n            }\n        } catch (e) {\n            console.error(\"Error loading rooms:\", e);\n            alert(\"Could not load rooms. Check console for details.\");\n        }\n    };\n    // --- –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ ---\n\n    return (\n        <div className=\"container mt-5\">\n            {!isInRoom ? (\n                // --- LOBBY SCREEN ---\n                <div className=\"card p-4 mx-auto\" style={{maxWidth: '500px'}}>\n                    <h2 className=\"text-center mb-4\">–ù–∞—Ö—É–π–ú–∞–∫—Å–ß–∞—Ç</h2>\n                    \n                    <div className=\"mb-3\">\n                        <label className=\"form-label\">–ù–∏–∫–Ω–µ–π–º</label>\n                        <input \n                            className=\"form-control\" \n                            placeholder=\"–í–≤–µ–¥–∏—Ç–µ –∏–º—è\"\n                            value={username}\n                            onChange={e => setUsername(e.target.value)} \n                        />\n                    </div>\n\n                    <hr />\n\n                    {/* Join Existing */}\n                    <h5>–í–æ–π—Ç–∏ –≤ –∫–æ–º–Ω–∞—Ç—É –ø–æ ID</h5>\n                    <div className=\"input-group mb-3\">\n                        <input \n                            className=\"form-control\" \n                            placeholder=\"ID –∫–æ–º–Ω–∞—Ç—ã\"\n                            value={roomId}\n                            onChange={e => setRoomId(e.target.value)}\n                        />\n                        <button className=\"btn btn-primary\" onClick={joinRoom}>–í—Ö–æ–¥</button>\n                    </div>\n\n                    {/* –ö–ù–û–ü–ö–ê –ü–û–ö–ê–ó–ê –ö–û–ú–ù–ê–¢ */}\n                    <button \n                        className=\"btn btn-outline-info w-100 mb-3\" \n                        onClick={loadUserRooms}\n                        disabled={!username}\n                    >\n                        {showRooms ? \"Hide Rooms\" : \"–ü–æ–∫–∞–∑–∞—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–Ω–∞—Ç—ã\"}\n                    </button>\n\n                    {/* –°–ü–ò–°–û–ö –ö–û–ú–ù–ê–¢ */}\n                    {showRooms && myRooms.length > 0 && (\n                        <div className=\"list-group mb-3\">\n                            {myRooms.map((room) => (\n                                <button \n                                    key={room.roomId}\n                                    className=\"list-group-item list-group-item-action d-flex justify-content-between align-items-center\"\n                                    onClick={() => joinSpecificRoom(room.roomId)}\n                                >\n                                    <div>\n                                        <strong>{room.roomName}</strong>\n                                        <div className=\"small text-muted\">ID: {room.roomId} | Creator: {room.creator}</div>\n                                    </div>\n                                    <span className=\"badge bg-primary rounded-pill\">\n                                        {room.userCount} users\n                                    </span>\n                                </button>\n                            ))}\n                        </div>\n                    )}\n\n                    <hr />\n\n                    {/* Create New */}\n                    <h5>–°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É</h5>\n                    <div className=\"mb-2\">\n                        <input \n                            className=\"form-control\" \n                            placeholder=\"–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã\"\n                            value={roomName}\n                            onChange={e => setRoomName(e.target.value)}\n                        />\n                    </div>\n                    <button className=\"btn btn-success w-100\" onClick={createRoom}>–°–æ–∑–¥–∞—Ç—å –∏ –≤–æ–π—Ç–∏</button>\n                </div>\n            ) : (\n                // --- CHAT ROOM SCREEN ---\n                <div className=\"card mx-auto\" style={{maxWidth: '800px', height: '80vh'}}>\n                    <div className=\"card-header d-flex justify-content-between align-items-center bg-primary text-white\">\n                        <h5 className=\"mb-0\">–í—ã –≤ –∫–æ–º–Ω–∞—Ç–µ: {roomId} (User: {username})</h5>\n                        <div>\n                            <button className=\"btn btn-sm btn-danger me-2\" onClick={deleteRoom}>–£–¥–∞–ª–∏—Ç—å –∫–æ–º–Ω–∞—Ç—É</button>\n                            <button className=\"btn btn-sm btn-warning\" onClick={leaveRoom}>–í—ã–π—Ç–∏</button>\n                        </div>\n                    </div>\n                    \n                    <div className=\"card-body overflow-auto d-flex flex-column\" style={{flex: 1, backgroundColor: '#f8f9fa'}}>\n                        {messages.map((msg, idx) => {\n                            const isMyMessage = msg.user === username;\n                            const isSystem = msg.type === 'system' || msg.type === 'join' || msg.type === 'leave' || msg.type === 'error';\n\n                            if (isSystem) {\n                                return (\n                                    <div key={idx} className=\"text-center text-muted small my-2\">\n                                        <em>[{msg.timestamp}] {msg.text}</em>\n                                    </div>\n                                );\n                            }\n\n                            return (\n                                <div key={idx} className={`d-flex mb-3 ${isMyMessage ? 'justify-content-end' : 'justify-content-start'}`}>\n                                    <div \n                                        className={`card px-3 py-2 ${isMyMessage ? 'bg-primary text-white' : 'bg-white border'}`}\n                                        style={{maxWidth: '70%', borderRadius: '15px', border: isMyMessage ? 'none' : '1px solid #ddd'}}\n                                    >\n                                        <div className=\"small fw-bold mb-1\" style={{opacity: 0.8}}>{msg.user}</div>\n                                        <div>{msg.text}</div>\n                                        <div className=\"small text-end mt-1\" style={{opacity: 0.7, fontSize: '0.7em'}}>{msg.timestamp}</div>\n                                    </div>\n                                </div>\n                            );\n                        })}\n                        <div ref={messagesEndRef} />\n                    </div>\n\n                    <div className=\"card-footer\">\n                        <div className=\"input-group\">\n                            <input \n                                type=\"text\" \n                                className=\"form-control\"\n                                placeholder=\"Type a message...\"\n                                value={inputText}\n                                onChange={e => setInputText(e.target.value)}\n                                onKeyDown={e => e.key === 'Enter' && sendMessage()}\n                            />\n                            <button className=\"btn btn-primary\" onClick={sendMessage} disabled={!connection || connection.state !== 'Connected'}>Send</button>\n                        </div>\n                    </div>\n                </div>\n            )}\n        </div>\n    );\n};\n\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}